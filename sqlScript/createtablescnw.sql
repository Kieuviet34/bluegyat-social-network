create table sc_users(
     USER_ID          NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      USERNAME         VARCHAR2(50) UNIQUE NOT NULL,
      FULL_NAME        VARCHAR2(100),
      EMAIL            VARCHAR2(100) UNIQUE NOT NULL,
      PASSWORD_HASH    VARCHAR2(256) NOT NULL,
      PROFILE_IMG_URL  VARCHAR2(500),   -- URL ảnh avatar
      COVER_IMG_URL    VARCHAR2(500),   -- URL ảnh bìa (tuỳ chọn)
      CREATED_AT       TIMESTAMP DEFAULT SYSTIMESTAMP
);

CREATE TABLE POSTS (
  POST_ID     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  USER_ID     NUMBER NOT NULL,
  CONTENT     CLOB NOT NULL,
  MEDIA_URL   VARCHAR2(500),        -- URL media kèm theo
  CREATED_AT  TIMESTAMP DEFAULT SYSTIMESTAMP,
  FOREIGN KEY (USER_ID) REFERENCES SC_USERS(USER_ID)
);

CREATE TABLE POST_MEDIA (
  MEDIA_ID   NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  POST_ID    NUMBER NOT NULL,
  MEDIA_URL  VARCHAR2(500) NOT NULL,
  SEQ_NO     NUMBER DEFAULT 1,      -- thứ tự hiển thị
  FOREIGN KEY (POST_ID) REFERENCES POSTS(POST_ID)
);

CREATE TABLE FRIENDSHIPS (
  USER_ID     NUMBER NOT NULL,
  FRIEND_ID   NUMBER NOT NULL,
  STATUS      VARCHAR2(20) DEFAULT 'PENDING',
  REQUESTED_AT TIMESTAMP DEFAULT SYSTIMESTAMP,
  ACCEPTED_AT  TIMESTAMP,
  PRIMARY KEY (USER_ID, FRIEND_ID),
  FOREIGN KEY (USER_ID)   REFERENCES SC_USERS(USER_ID),
  FOREIGN KEY (FRIEND_ID) REFERENCES SC_USERS(USER_ID)
);

CREATE TABLE COMMENTS (
  COMMENT_ID   NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  POST_ID      NUMBER NOT NULL,
  USER_ID      NUMBER NOT NULL,
  CONTENT      VARCHAR2(1000) NOT NULL,
  IMG_URL      VARCHAR2(500),       -- URL ảnh đính kèm (tuỳ chọn)
  CREATED_AT   TIMESTAMP DEFAULT SYSTIMESTAMP,
  FOREIGN KEY (POST_ID) REFERENCES POSTS(POST_ID),
  FOREIGN KEY (USER_ID) REFERENCES SC_USERS(USER_ID)
);
CREATE TABLE NOTIFICATIONS (
  NOTIF_ID          NUMBER                       GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  RECIPIENT_USER_ID NUMBER                       NOT NULL,  -- ai sẽ nhận thông báo
  ACTOR_USER_ID     NUMBER,                                 -- ai đã thực hiện hành động (like, comment, friend request)
  TYPE              VARCHAR2(30)                  NOT NULL,  -- 'FRIEND_REQUEST', 'LIKE', 'COMMENT'
  ENTITY_ID         NUMBER,                                 -- ID của thực thể liên quan (ví dụ: POST_ID hoặc FRIEND_ID)
  ENTITY_TYPE       VARCHAR2(20),                          -- 'POST' hay 'FRIEND_REQUEST'
  MESSAGE           VARCHAR2(4000),                       -- Tin nhắn hiện thị (ví dụ: "Alice liked your post")
  IS_READ           CHAR(1)        DEFAULT 'N' NOT NULL,   -- 'N' chưa đọc, 'Y' đã đọc
  CREATED_AT        TIMESTAMP      DEFAULT SYSTIMESTAMP NOT NULL
);
 
-- Chỉ số thuận lợi để tìm notification của từng người
CREATE INDEX IDX_NOTIF_RECIPIENT
  ON NOTIFICATIONS(RECIPIENT_USER_ID);

select * from friendships;
    